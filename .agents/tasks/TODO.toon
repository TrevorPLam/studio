# AI Work TODO (TOON) — 3–5 active tasks from REPOSITORY-STATE-REPORT.md

meta{status, owner, last_updated, source}:
[Active], [Team], [2026-01-31], [REPOSITORY-STATE-REPORT.md]

active_work[4]{id, title, status, priority, owner, due, description, acceptance_criteria, dependencies, notes, designation}:
[TASK-005], [Extract shared auth/session helpers], [In Progress], [P1], [Agent], [2025-02-28], [getUserId and ensureTimestamps duplicated in 6+ route files and agents page; change requires edits in many places.], [Single module exports getUserId and ensureTimestamps; no duplicate definitions in route or page files.], [TASK-002], [Short-term. Promote to TODO when slot free.], [AGENT]
[TASK-006], [Update README and CONTRIBUTING], [Not Started], [P1], [Agent], [2025-02-28], [README project structure lists infrastructure/ docs/ tools/ which do not exist; no Developer setup; CONTRIBUTING may have outdated steps.], [README structure matches repo; Developer setup section present; CONTRIBUTING accurate.], [None], [Short-term.], [AGENT]
[TASK-008], [Add next.config for web app], [Not Started], [P1], [Agent], [2025-02-28], [No next.config at apps/web; path aliases and future security headers or bundle config have no place.], [next.config exists; build and dev unchanged or improved.], [None], [Short-term.], [AGENT]
[TASK-009], [Expand test coverage], [Not Started], [P1], [Agent], [2025-03-31], [Only one smoke test planned; validation sanitization path-policy and critical API flows untested.], [Unit tests for validation sanitization path-policy; integration tests for auth and critical flows; coverage in CI.], [TASK-004], [Medium-term.], [AGENT]

active_work_subtasks[12]{task_id, subtitle, designation, description}:
[TASK-005], [Create lib/auth-helpers.ts (or features/auth) with getUserId and ensureTimestamps], [AGENT], [Implement and export getUserId(session) and ensureTimestamps(messages).]
[TASK-005], [Refactor API routes to use shared helpers], [AGENT], [Update killswitch chat chat-stream sessions sessions/[id] sessions/[id]/steps to use shared module.]
[TASK-005], [Refactor app/agents/[id]/page.tsx to use ensureTimestamps], [AGENT], [Remove local ensureTimestamps; import from shared module.]
[TASK-006], [Update README project structure section], [AGENT], [List scripts/ and actual layout; remove or correct infrastructure/ docs/ tools/.]
[TASK-006], [Add Developer setup section to README], [AGENT], [Clone; pnpm install; copy .env.example; list required env vars; pnpm dev build test.]
[TASK-006], [Verify CONTRIBUTING links and steps], [AGENT], [Fix broken links and outdated steps.]
[TASK-008], [Add next.config.js or next.config.mjs], [AGENT], [Create config file at apps/web or root.]
[TASK-008], [Add path aliases if needed], [AGENT], [Configure path aliases in next.config if required.]
[TASK-008], [Add placeholder for security headers], [AGENT], [Comment or minimal config for future CSP X-Frame-Options etc.]
[TASK-009], [Add unit tests for validation sanitization path-policy], [AGENT], [Cover lib/validation.ts lib/security/sanitize.ts lib/security/path-policy.ts.]
[TASK-009], [Add integration tests for auth and critical API flows], [AGENT], [Cover auth chat sessions GitHub routes as applicable.]
[TASK-009], [Wire coverage into Turbo and CI], [AGENT], [Ensure coverage output and CI report or gate.]
